{
  "schema_version": "1.0",
  "attestation_type": "non_agent_direct_write",
  "subject": {
    "repo": "shizuku198411/SessionAttested-PoC-Repo",
    "commit_sha": "1d7ebb0c8c501a694714cb9f64859f8ee43b3ce7",
    "ref": ""
  },
  "session": {
    "session_id": "07c478c3d61954ae491a5bf4822b241d",
    "workspace": {
      "host_path": "/home/pyxgun/sandbox/attested_poc",
      "container_path": "/workspace"
    },
    "commit_binding": {
      "commit_sha": "1d7ebb0c8c501a694714cb9f64859f8ee43b3ce7",
      "parent_sha": "94e5693d1750d32a1e704d1d289c08727c3a3887",
      "repo_path": ".",
      "created_rfc3339": "2026-02-24T07:03:03Z"
    },
    "commit_bindings": [
      {
        "commit_sha": "1d7ebb0c8c501a694714cb9f64859f8ee43b3ce7",
        "parent_sha": "94e5693d1750d32a1e704d1d289c08727c3a3887",
        "repo_path": ".",
        "created_rfc3339": "2026-02-24T07:03:03Z"
      }
    ]
  },
  "environment": {
    "mode": "docker_poc",
    "collector": {
      "name": "session-attested-collector",
      "version": "0.1.0",
      "node_id": "poc-node"
    },
    "developer_container": {
      "runtime": "docker",
      "container_id": "fe975f3474d71698a219d0c4c424d5a2b6321c0288216830b5271895ff86ac8e",
      "image": {
        "name": "attested_base:latest"
      }
    }
  },
  "policy": {
    "policy_id": "attested_poc-policy",
    "policy_version": "1.0.1",
    "ruleset_hash": "sha256:ca2fb483248d378125189a8ca64ca13978c66bfcf71f4028ec3f6fe58c2c1813",
    "forbidden_exec": [
      {
        "sha256": "sha256:ee2d5f97c1dbc39fc28f66383e173ffae55420512ec0f420ff46758e2f1111c9",
        "comment": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/bin/code-server"
      },
      {
        "sha256": "sha256:c8c89c91b842b5852dea0863836e24d38fec55c263a5b4377e54b40886a1cdb9",
        "comment": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node"
      },
      {
        "sha256": "sha256:26ce6cceb17ac710ee7253c49ea825c618d4f9e49a135d52b4edce336c40f620",
        "comment": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node_modules/@vscode/ripgrep/bin/rg"
      },
      {
        "sha256": "sha256:2bfe7e6f1939a446c2a4d21998202a247ce58edb1890e10d97b633a91e5a71b5",
        "comment": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/out/vs/base/node/cpuUsage.sh"
      },
      {
        "sha256": "sha256:b5bcad68e567f13e111d24b5dc9a7abc544b4dc81c4817ab5518789461581ac6",
        "comment": "/home/dev/.vscode-server/code-072586267e68ece9a47aa43f8c108e0dcbf44622"
      }
    ],
    "forbidden_writers": [
      {
        "sha256": "sha256:c8c89c91b842b5852dea0863836e24d38fec55c263a5b4377e54b40886a1cdb9",
        "comment": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node"
      }
    ]
  },
  "audit_summary": {
    "window": {
      "start_rfc3339": "2026-02-24T07:02:19Z",
      "end_rfc3339": "2026-02-24T07:03:03Z"
    },
    "exec_observed": {
      "count": 378,
      "forbidden_seen": 5,
      "identity_unresolved": 5,
      "identity_unresolved_hints": [
        "pid=482392 comm=codex fn=/home/dev/.codex/tmp/arg0/codex-arg0SLB2Zq/lsb_release",
        "pid=482392 comm=codex fn=/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/bin/remote-cli/lsb_release",
        "pid=482392 comm=codex fn=/usr/local/sbin/lsb_release",
        "pid=482392 comm=codex fn=/usr/local/bin/lsb_release",
        "pid=482392 comm=codex fn=/usr/sbin/lsb_release"
      ]
    },
    "executed_identities": [
      {
        "sha256": "sha256:0b3c9b95118dbb6c31848729f708607cdc696631a2a9cb33fe65164b1c169f38",
        "inode": 2304,
        "dev": 2050,
        "path_hint": "/usr/bin/readlink"
      },
      {
        "sha256": "sha256:12d09f922c013d07b62cca4fda15a567d94133b196c23193784f1725562ad754",
        "inode": 1598,
        "dev": 2050,
        "path_hint": "/etc/update-motd.d/50-motd-news"
      },
      {
        "sha256": "sha256:1ae5e306bce2eca707ff5cd25ede118b24a80ca85cd85a6eb7d658d81abd3dfa",
        "inode": 2466,
        "dev": 2050,
        "path_hint": "/usr/bin/sleep"
      },
      {
        "sha256": "sha256:26b759d8838d10b0ad5bd0142f004f8b1ae94b32664834f9fa0cc4f21bc815b7",
        "inode": 1794,
        "dev": 2050,
        "path_hint": "/usr/bin/cat"
      },
      {
        "sha256": "sha256:26ce6cceb17ac710ee7253c49ea825c618d4f9e49a135d52b4edce336c40f620",
        "inode": 9004402,
        "dev": 1048687,
        "path_hint": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node_modules/@vscode/ripgrep/bin/rg"
      },
      {
        "sha256": "sha256:2bfe7e6f1939a446c2a4d21998202a247ce58edb1890e10d97b633a91e5a71b5",
        "inode": 9002325,
        "dev": 1048687,
        "path_hint": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/out/vs/base/node/cpuUsage.sh"
      },
      {
        "sha256": "sha256:385052662d7d365d8b47810670d4bc0af0f48c0f5564786a5bc1b819be2dcb06",
        "inode": 1746,
        "dev": 2050,
        "path_hint": "/usr/bin/basename"
      },
      {
        "sha256": "sha256:3fa1c04e29647304817b1ffe9a7600dc80c879ea4c8a9302032799830e0c2133",
        "inode": 30988,
        "dev": 2050,
        "path_hint": "/usr/bin/ps"
      },
      {
        "sha256": "sha256:44699b32c0f2727905800bd05bc09c72c20946f4ad68a7c9a58aaba4c0958620",
        "inode": 3268,
        "dev": 2050,
        "path_hint": "/usr/bin/docker"
      },
      {
        "sha256": "sha256:484188f4b37b4021998dafd1966cda1c6f8207af9aee3ad51746a5d22acf3e65",
        "inode": 2096,
        "dev": 2050,
        "path_hint": "/bin/lsb_release"
      },
      {
        "sha256": "sha256:4acc7a0b3ba8b47f613257b1a806ca9f39c0d1ac261a1be48385ea41116a77de",
        "inode": 1881,
        "dev": 2050,
        "path_hint": "/usr/bin/dircolors"
      },
      {
        "sha256": "sha256:4ae6774eca121005b8e6187616ba675f9af7abdda20818e3df55c1539711e241",
        "inode": 2315,
        "dev": 2050,
        "path_hint": "/usr/bin/rm"
      },
      {
        "sha256": "sha256:52fce2acbdfd62a9a34b1729ab433e6c344b2eb96ac274b04e87ad7d98a6d43d",
        "inode": 1846,
        "dev": 2050,
        "path_hint": "/usr/bin/curl"
      },
      {
        "sha256": "sha256:59e7cf8b9bd8711ae1aa6f7bbbd4132b61492409c3afe8e1505225efda1cb8f6",
        "inode": 2653,
        "dev": 2050,
        "path_hint": "/usr/bin/which"
      },
      {
        "sha256": "sha256:76f61a0c1f44f040454835d45424d0ae740eaf1515709bbfc9b1fc4de6a8ec41",
        "inode": 2593,
        "dev": 2050,
        "path_hint": "/usr/bin/uname"
      },
      {
        "sha256": "sha256:7e104be971478cbf9406c8c718659473122ea8e39723f0aba27e3b28825b8274",
        "inode": 2094,
        "dev": 2050,
        "path_hint": "/usr/bin/ls"
      },
      {
        "sha256": "sha256:875bbfa64ca563363629ce4aa4778e937e48ffc668562a798159095dcaf365be",
        "inode": 2362,
        "dev": 2050,
        "path_hint": "/usr/bin/sed"
      },
      {
        "sha256": "sha256:8b93b575ba20149573f8e64ed7c3e43e44de44b439dbebf9df87997ec1b4a719",
        "inode": 1804,
        "dev": 2050,
        "path_hint": "/usr/bin/chmod"
      },
      {
        "sha256": "sha256:93fd34381ad0ba02987818df0f4e6dfdf47d3a606ffd28749e8df48aedde5a68",
        "inode": 2071,
        "dev": 2050,
        "path_hint": "/usr/bin/lesspipe"
      },
      {
        "sha256": "sha256:9506bcf988e064657688589bea0f2c32fa766bf6041c049f5b8c8b877cd8ec37",
        "inode": 1884,
        "dev": 2050,
        "path_hint": "/usr/bin/dirname"
      },
      {
        "sha256": "sha256:9d3b4c4c9f60e389062e77b22493316123b92ff19327d30437e5e4583933a738",
        "inode": 2542,
        "dev": 2050,
        "path_hint": "/usr/bin/tail"
      },
      {
        "sha256": "sha256:a0bf35fb6e8053a4b9026090016d0e8d1e870705cde7c9f750d58445c4aa700d",
        "inode": 2330,
        "dev": 2050,
        "path_hint": "/usr/bin/run-parts"
      },
      {
        "sha256": "sha256:a241b34559d0bf762359bdc120babccab6873b8e97b0fae206523fac30126f1e",
        "inode": 5921,
        "dev": 2050,
        "path_hint": "/usr/bin/ldd"
      },
      {
        "sha256": "sha256:a36dee6e233f52ea368eee6728f791e7c5ad36ea7bcda396bb256a731d346396",
        "inode": 3254,
        "dev": 2050,
        "path_hint": "/usr/bin/vim"
      },
      {
        "sha256": "sha256:a95219a95160120ffe2f418bb4302280da98184d0e08b4e02c1b2459de7efa69",
        "inode": 2564,
        "dev": 2050,
        "path_hint": "/usr/bin/touch"
      },
      {
        "sha256": "sha256:aa6540695d076182256dd6e96c8b302e4d56381e3000bbfd5c71bbdfe94a4942",
        "inode": 10999,
        "dev": 2050,
        "path_hint": "/usr/bin/git"
      },
      {
        "sha256": "sha256:aa6540695d076182256dd6e96c8b302e4d56381e3000bbfd5c71bbdfe94a4942",
        "inode": 11002,
        "dev": 2050,
        "path_hint": "/usr/lib/git-core/git"
      },
      {
        "sha256": "sha256:af1cb469d4a017e28359248cf8ae16a08b3fe013c54b243210ef5b9f74158a51",
        "inode": 2020,
        "dev": 2050,
        "path_hint": "/usr/bin/id"
      },
      {
        "sha256": "sha256:af955ef55333c8fc9c5aa50df91ad1a629d9a79a9afa125cd5e9629585f78015",
        "inode": 1748,
        "dev": 2050,
        "path_hint": "/bin/bash"
      },
      {
        "sha256": "sha256:b5bcad68e567f13e111d24b5dc9a7abc544b4dc81c4817ab5518789461581ac6",
        "inode": 9001626,
        "dev": 1048687,
        "path_hint": "/home/dev/.vscode-server/code-072586267e68ece9a47aa43f8c108e0dcbf44622"
      },
      {
        "sha256": "sha256:bec5950dc8bd999881076b8e5bb2be1cbe45e9f7847d4110ee76fc490dc5d616",
        "inode": 5135,
        "dev": 2050,
        "path_hint": "/usr/bin/getconf"
      },
      {
        "sha256": "sha256:bfd5df90c7f070feab584435f106f254ffffaa268a04de5b5c3bd61d59c092f3",
        "inode": 10387,
        "dev": 2050,
        "path_hint": "/sbin/ldconfig"
      },
      {
        "sha256": "sha256:c7507963900c83fffa7ca018c5ab28c79804e9f4736ef67e4cbf263acbc82376",
        "inode": 48430,
        "dev": 2050,
        "path_hint": "/usr/sbin/sshd"
      },
      {
        "sha256": "sha256:c883d9c27228339580994a1d0ea960645368c7d1b960a712bd0c655860c2d0d7",
        "inode": 1849,
        "dev": 2050,
        "path_hint": "/bin/sh"
      },
      {
        "sha256": "sha256:c8c89c91b842b5852dea0863836e24d38fec55c263a5b4377e54b40886a1cdb9",
        "inode": 9001634,
        "dev": 1048687,
        "path_hint": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node"
      },
      {
        "sha256": "sha256:d1f54612dda30258f1ff887f3ce6068479d88a188176da200c9f608e249f3134",
        "inode": 1595,
        "dev": 2050,
        "path_hint": "/etc/update-motd.d/00-header"
      },
      {
        "sha256": "sha256:db2758b407abf39d6efda276347d2e6203799952ba43b842c2e7d18e35700875",
        "inode": 1850,
        "dev": 2050,
        "path_hint": "/usr/bin/date"
      },
      {
        "sha256": "sha256:dc3a00a8bbe51dad1e958d6c5f73a59a6ed61a9e37acec36a78a1e817e5cadd4",
        "inode": 1596,
        "dev": 2050,
        "path_hint": "/etc/update-motd.d/10-help-text"
      },
      {
        "sha256": "sha256:e0cf7e677aa546fad67b1579ca1cabb9364caebf7988a59018d0a4e8376cefe7",
        "inode": 1920,
        "dev": 2050,
        "path_hint": "/usr/bin/env"
      },
      {
        "sha256": "sha256:e1dc5ce642b5de0eb7c0c20d3362fd7c9d1748befed8695586f59626108abbd9",
        "inode": 5517798,
        "dev": 1048687,
        "path_hint": "/etc/update-motd.d/60-unminimize"
      },
      {
        "sha256": "sha256:e70291f7cb9dfc5d6a4182a364582a5941cd4845c9416729dd9e47994ba26575",
        "inode": 2085,
        "dev": 2050,
        "path_hint": "/usr/bin/locale-check"
      },
      {
        "sha256": "sha256:ec9e4fd88d47221da35d1e8f629dc5af28578f2d373baa5390df09da495f1928",
        "inode": 1722,
        "dev": 2050,
        "path_hint": "/usr/local/bin/attested"
      },
      {
        "sha256": "sha256:ee2d5f97c1dbc39fc28f66383e173ffae55420512ec0f420ff46758e2f1111c9",
        "inode": 9002315,
        "dev": 1048687,
        "path_hint": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/bin/code-server"
      },
      {
        "sha256": "sha256:f211b442bfb2eb20e4d6d7c0593b34ec421a5bcd630873c69ed7aaedeea28a26",
        "inode": 9006529,
        "dev": 1048687,
        "path_hint": "/home/dev/.vscode-server/extensions/openai.chatgpt-0.4.76-linux-arm64/bin/linux-aarch64/codex"
      },
      {
        "sha256": "sha256:f2a4948219b81a153d8cafe85383acb2f734cdccac00b633891da1cc8532f8f9",
        "inode": 10389,
        "dev": 2050,
        "path_hint": "/sbin/ldconfig.real"
      },
      {
        "sha256": "sha256:fb7efa5f6b958b44258b08ab860b086aaa0446b8b50564b3d43367b2ba4ed407",
        "inode": 1993,
        "dev": 2050,
        "path_hint": "/usr/bin/grep"
      }
    ],
    "workspace_writes_observed": {
      "count": 6,
      "by_op": {
        "open_write": 6
      },
      "forbidden_writer_seen": 1
    },
    "workspace_files": [
      {
        "path": "/workspace/.git/HEAD.lock",
        "write_count": 1,
        "by_op": {
          "open_write": 1
        },
        "writers": [
          {
            "sha256": "sha256:aa6540695d076182256dd6e96c8b302e4d56381e3000bbfd5c71bbdfe94a4942",
            "inode": 10999,
            "dev": 2050,
            "path_hint": "/usr/bin/git"
          }
        ],
        "comms": [
          "git"
        ]
      },
      {
        "path": "/workspace/.git/index.lock",
        "write_count": 2,
        "by_op": {
          "open_write": 2
        },
        "writers": [
          {
            "sha256": "sha256:aa6540695d076182256dd6e96c8b302e4d56381e3000bbfd5c71bbdfe94a4942",
            "inode": 10999,
            "dev": 2050,
            "path_hint": "/usr/bin/git"
          }
        ],
        "comms": [
          "git"
        ]
      },
      {
        "path": "/workspace/.git/objects/maintenance.lock",
        "write_count": 1,
        "by_op": {
          "open_write": 1
        },
        "writers": [
          {
            "sha256": "sha256:aa6540695d076182256dd6e96c8b302e4d56381e3000bbfd5c71bbdfe94a4942",
            "inode": 11002,
            "dev": 2050,
            "path_hint": "/usr/lib/git-core/git"
          }
        ],
        "comms": [
          "git"
        ]
      },
      {
        "path": "/workspace/.git/refs/heads/main.lock",
        "write_count": 1,
        "by_op": {
          "open_write": 1
        },
        "writers": [
          {
            "sha256": "sha256:aa6540695d076182256dd6e96c8b302e4d56381e3000bbfd5c71bbdfe94a4942",
            "inode": 10999,
            "dev": 2050,
            "path_hint": "/usr/bin/git"
          }
        ],
        "comms": [
          "git"
        ]
      },
      {
        "path": "/workspace/src/created_by_vscode-ssh.txt",
        "write_count": 1,
        "by_op": {
          "open_write": 1
        },
        "writers": [
          {
            "sha256": "sha256:c8c89c91b842b5852dea0863836e24d38fec55c263a5b4377e54b40886a1cdb9",
            "inode": 9001634,
            "dev": 1048687,
            "path_hint": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node"
          }
        ],
        "comms": [
          "libuv-worker"
        ]
      }
    ],
    "writer_identities": [
      {
        "sha256": "sha256:aa6540695d076182256dd6e96c8b302e4d56381e3000bbfd5c71bbdfe94a4942",
        "inode": 10999,
        "dev": 2050,
        "path_hint": "/usr/bin/git"
      },
      {
        "sha256": "sha256:aa6540695d076182256dd6e96c8b302e4d56381e3000bbfd5c71bbdfe94a4942",
        "inode": 11002,
        "dev": 2050,
        "path_hint": "/usr/lib/git-core/git"
      },
      {
        "sha256": "sha256:c8c89c91b842b5852dea0863836e24d38fec55c263a5b4377e54b40886a1cdb9",
        "inode": 9001634,
        "dev": 1048687,
        "path_hint": "/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node"
      }
    ]
  },
  "integrity": {
    "event_root": "c62c8c36849b3740911bd124147c95b7f9335074f5e06aa64a53029da065d10c",
    "event_root_alg": "hash_chain_sha256",
    "event_count": 384,
    "collector_log_id": "ebpf-lsm:07c478c3d61954ae491a5bf4822b241d"
  },
  "conclusion": {
    "pass": false,
    "reasons": [
      {
        "code": "FORBIDDEN_EXEC_SEEN",
        "detail": "count=5 samples=[sha256:26ce6cceb(/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node_modules/@vscode/ripgrep/bin/rg), sha256:2bfe7e6f1(/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/out/vs/base/node/cpuUsage.sh), sha256:b5bcad68e(/home/dev/.vscode-server/code-072586267e68ece9a47aa43f8c108e0dcbf44622), sha256:c8c89c91b(/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node), sha256:ee2d5f97c(/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/bin/code-server)]"
      },
      {
        "code": "FORBIDDEN_WRITER_SEEN",
        "detail": "count=1 samples=[sha256:c8c89c91b(/home/dev/.vscode-server/cli/servers/Stable-072586267e68ece9a47aa43f8c108e0dcbf44622/server/node)]"
      }
    ]
  },
  "issued_at": "2026-02-24T07:03:09Z",
  "issuer": {
    "name": "attested_poc-attestor",
    "key_id": "attested_poc-key-1",
    "method": "ed25519"
  }
}
